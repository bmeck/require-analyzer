#!/usr/bin/env node

var Module = require('module').Module,
    __load = Module._load,
    packages = {};

//
// Monkey punch `Module._load()` to observe the names
// of packages as they are loaded. 
//
Module._load = function (name) {
  console.log('__!load::' + name);
  return __load.apply(Module, arguments);
}

try {    
  require(process.argv[2]);
  
  process.nextTick(function () {
    process.exit(0);
  });
}
catch (ex) {
  //
  // Log errors and attempt to log as many packages as we can.
  //
  ex.stack.split('\n').forEach(function (line) {
    console.error('__!err::' + line);
  });
}